<!DOCTYPE html>
<html lang="pl">
<head>
    <meta charset="UTF-8">
    <title>ReturnQR â€“ Panel testowy</title>
</head>
<body>
<h1>ReturnQR â€“ Panel testowy</h1>

<!-- USER SECTION -->
<h2>UÅ¼ytkownicy</h2>
<form id="userForm">
    <input type="text" id="name" placeholder="ImiÄ™ i nazwisko" required>
    <input type="email" id="email" placeholder="Email" required>
    <button type="submit">â• Dodaj uÅ¼ytkownika</button>
</form>

<button onclick="loadUsers()">ğŸ“‹ PokaÅ¼ uÅ¼ytkownikÃ³w</button>
<ul id="usersList"></ul>

<h3>UsuÅ„ uÅ¼ytkownika</h3>
<input type="number" id="deleteUserId" placeholder="User ID">
<button onclick="deleteUser()">ğŸ—‘ï¸ UsuÅ„ uÅ¼ytkownika</button>

<hr>

<!-- PARCEL SECTION -->
<h2>Paczki</h2>
<form id="parcelForm">
    <input type="number" id="userId" placeholder="User ID (wÅ‚aÅ›ciciel)" required>
    <input type="text" id="deliveryAddress" placeholder="Adres dostawy" required>
    <input type="text" id="returnAddress" placeholder="Adres zwrotu" required>
    <select id="status">
        <option value="SENT">SENT</option>
        <option value="RETURN">RETURN</option>
    </select>
    <button type="submit">â• Dodaj paczkÄ™</button>
</form>

<h3>Pobierz paczkÄ™</h3>
<input type="number" id="parcelId" placeholder="Parcel ID">
<button onclick="loadParcel()">ğŸ“¦ PokaÅ¼ paczkÄ™</button>
<pre id="parcelDetails"></pre>

<h3>ZmieÅ„ status paczki</h3>
<input type="number" id="parcelIdStatus" placeholder="Parcel ID">
<select id="newStatus">
    <option value="SENT">SENT</option>
    <option value="RETURN">RETURN</option>
</select>
<button onclick="updateStatus()">ğŸ”„ ZmieÅ„ status</button>

<h3>UsuÅ„ paczkÄ™</h3>
<input type="number" id="deleteParcelId" placeholder="Parcel ID">
<button onclick="deleteParcel()">ğŸ—‘ï¸ UsuÅ„ paczkÄ™</button>

<script>
    const apiUrl = "http://localhost:8080";

    // â• Dodaj usera
    document.getElementById("userForm").addEventListener("submit", async e => {
        e.preventDefault();
        const user = {
            name: document.getElementById("name").value,
            email: document.getElementById("email").value
        };
        const res = await fetch(`${apiUrl}/users`, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify(user)
        });
        alert("Dodano usera: " + res.status);
    });

    // ğŸ“‹ Pobierz userÃ³w
    async function loadUsers() {
        const res = await fetch(`${apiUrl}/users`);
        const users = await res.json();
        const list = document.getElementById("usersList");
        list.innerHTML = "";
        users.forEach(u => {
            const li = document.createElement("li");
            li.textContent = `${u.id}: ${u.name} (${u.email})`;
            list.appendChild(li);
        });
    }

    // ğŸ—‘ï¸ UsuÅ„ usera
    async function deleteUser() {
        const id = document.getElementById("deleteUserId").value;
        const res = await fetch(`${apiUrl}/users/${id}`, { method: "DELETE" });
        alert("UsuniÄ™cie usera: " + res.status);
    }

    // â• Dodaj paczkÄ™
    document.getElementById("parcelForm").addEventListener("submit", async e => {
        e.preventDefault();
        const userId = document.getElementById("userId").value;
        const parcel = {
            deliveryAddress: document.getElementById("deliveryAddress").value,
            returnAddress: document.getElementById("returnAddress").value,
            parcelStatus: document.getElementById("status").value
        };
        const res = await fetch(`${apiUrl}/users/${userId}/parcels`, {
            method: "POST",
            headers: {"Content-Type": "application/json"},
            body: JSON.stringify(parcel)
        });
        alert("Dodano paczkÄ™: " + res.status);
    });

    // ğŸ“¦ Pobierz paczkÄ™
    async function loadParcel() {
        const id = document.getElementById("parcelId").value;
        const res = await fetch(`${apiUrl}/parcels/${id}`);
        if (res.status === 404) {
            document.getElementById("parcelDetails").textContent = "Nie znaleziono paczki";
            return;
        }
        const parcel = await res.json();
        document.getElementById("parcelDetails").textContent = JSON.stringify(parcel, null, 2);
    }

    // ğŸ”„ ZmieÅ„ status paczki
    async function updateStatus() {
        const id = document.getElementById("parcelIdStatus").value;
        const status = document.getElementById("newStatus").value;

        const res = await fetch(`${apiUrl}/parcels/${id}/status?status=${status}`, {
            method: "PUT"
        });
        alert("Zmiana statusu: " + res.status);
    }

    // ğŸ—‘ï¸ UsuÅ„ paczkÄ™
    async function deleteParcel() {
        const id = document.getElementById("deleteParcelId").value;
        const res = await fetch(`${apiUrl}/parcels/${id}`, { method: "DELETE" });
        alert("UsuniÄ™cie paczki: " + res.status);
    }
</script>
</body>
</html>
